(function(){"use strict";angular.module("feryzApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ui.router","ui.bootstrap","ui.select","pascalprecht.translate","angular-loading-bar","toastr","http-auth-interceptor","ui.grid","ui.grid.edit","ui.grid.resizeColumns","ui.grid.exporter","ui.grid.selection","ui.grid.cellNav","ui.grid.autoResize","FBAngular","ngMaterial","angular-svg-round-progress","camera","ngFileUpload","angular-barcode","ui.utils.masks","cfp.hotkeys"]).constant("App",function(){var a,b,c;return a=location.protocol+"//"+location.hostname+"/feryz_server/public/",location.hostname.match("localhost")&&(a="http://localhost/"),c=a+"api/",b=a+"feryz/",{Server:c,views:"views/",images:a+"images/",perfilPath:c+"images/perfil/",imgSystemPath:c+"images/eventos/"}}()).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",administrador:"Administrador",vendedor:"Vendedor",tecnico:"Técnico"}).constant("PERMISSIONS",{can_work_like_admin:"can_work_like_admin",can_work_like_vendedor:"can_work_like_vendedor",can_work_like_tecnico:"can_work_like_tecnico",can_edit_usuarios:"can_edit_usuarios"})}).call(this),function(){"use strict";angular.module("feryzApp").controller("MainCtrl",["$scope","$window","$interval",function(a,b,c){}]).controller("LandingCtrl",["$scope","$window","$interval",function(a,b,c){}])}.call(this),function(){"use strict";angular.module("feryzApp").controller("ApplicationController",["$scope","USER_ROLES","AuthService","toastr","$state","$rootScope","$http","$filter","Local",function(a,b,c,d,e,f,g,h,i){return a.isAuthorized=c.isAuthorized,a.hasRoleOrPerm=c.hasRoleOrPerm,a.USER_ROLES=b,a.isLoginPage=!1,i.createTables(),a.main={skin:21},a.aplicacion={navFull:!0},a.toggleNav=function(){return a.aplicacion.navFull=!a.aplicacion.navFull},a.ocultarNav=function(){return a.aplicacion.navFull=!1},a.mostrarNav=function(){return a.aplicacion.navFull=!0},a.getNavFull=function(){return a.aplicacion.navFull},a.tema="theme-zero",a.cambiarTema=function(b){return a.tema=b},a.floatingSidebar=0,a.toggleFloatingSidebar=function(){return a.floatingSidebar=a.floatingSidebar?!1:!0}}])}.call(this),function(){angular.module("feryzApp").config(["$cookiesProvider","$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider","App","PERMISSIONS","$intervalProvider","$rootScopeProvider","USER_ROLES","toastrConfig","uiSelectConfig","hotkeysProvider",function(a,b,c,d,e,f,g,h,i,j,k,l,m){return d.defaults.useXDomain=!0,delete d.defaults.headers.common["X-Requested-With"],d.defaults.headers.common.Accept="application/json",d.defaults.headers.common["Content-Type"]="application/json",d.interceptors.push(["$q",function(a){return{request:function(a){var b;return b=a.url.split("::"),b.length>1?a.url=f.Server+b[1]:(b=a.url.split("=="),b.length>1&&(a.url=f.views+b[1])),a}}}]),l.theme="select2",l.resetSearchInput=!0,m.useNgRoute=!1,m.templateHeader='<h4 class="cfp-hotkeys-title">Accesos de teclado</h4>',c.otherwise("/login"),b.state("main",{url:"/",views:{principal:{templateUrl:f.views+"main/main.tpl.html",controller:"MainCtrl"}},data:{pageTitle:"En Construcción"}}).state("landing",{url:"/landing",views:{principal:{templateUrl:f.views+"main/landing.tpl.html",controller:"LandingCtrl"}},data:{pageTitle:"Inicio Feryz"}}).state("login",{url:"/login",views:{principal:{templateUrl:f.views+"login/login.tpl.html",controller:"LoginCtrl"}},data:{pageTitle:"Ingresar a Feryz"}}).state("logout",{url:"/logout",views:{principal:{templateUrl:f.views+"login/logout.tpl.html",controller:"LogoutCtrl"}},data:{icon_fa:"fa fa-user"}}),i.bigLoader=!0,_.mixin({findByValues:function(a,b,c){var d;return d=_.filter(a,function(a){return _.contains(c,a[b])}),0===d.length?!1:d[0]}}),angular.extend(k,{allowHtml:!0,closeButton:!0,extendedTimeOut:1e3,preventOpenDuplicates:!1,maxOpened:3,tapToDismiss:!0,target:"body",timeOut:4e3}),this}]).filter("capitalize",function(){return function(a,b){return a?a.replace(/([^\W_]+[^\s-]*) */g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}):""}})}.call(this),function(){angular.module("feryzApp").run(["$rootScope","cfpLoadingBar","$state","$stateParams","$translate","$cookies","Perfil","AuthService","AUTH_EVENTS","toastr",function(a,b,c,d,e,f,g,h,i,j){var k;return a.examen_actual=[],a.$state=c,a.$stateParams=d,a.lastState=null,a.lastStateParam=null,a.$on("event:auth-loginRequired",function(a){return console.log("Acceso no permitido, vamos a loguear",a),c.transitionTo("login")}),k=function(){return null===a.lastState||"login"===a.lastState||"/"===a.lastState||"main"===a.lastState?c.go("panel"):c.go(a.lastState,a.lastStateParam)},a.$on("event:auth-loginConfirmed",function(){return console.log("Logueado con éxito!"),k()}),a.$on("$stateChangeStart",function(b,c,d,e,f){return null===a.lastState||"logout"!==c.name&&"login"!==c.name&&"main"!==c.name?(a.lastState=c.name,a.lastStateParam=d):void 0}),a.$on("$stateChangeSuccess",function(b,d,e,f,g){return a.pageTitle=c.current.name}),a.$on("$stateChangeError",function(b,d,e,f,g){return console.log(a.lastState,"-Evento fallido: ",b),j.warning("Lo sentimos, hubo un error o no puedes acceder a esta vista"),"panel"!==a.lastState?c.transitionTo("panel"):c.transitionTo("login")}),a.$on("$translatePartialLoaderStructureChanged",function(){return e.refresh(),console.log("Translate refrescado supuestamente.")}),a.$on(i.loginSuccess,function(){return k()}),a.$on(i.loginFailed,function(a){}),a.$on(i.notAuthenticated,function(a){return j.warning("No está autorizado.","Acceso exclusivo"),console.log("Evento notAuthenticated: ",a),c.transitionTo("login")}),a.$on(i.notAuthorized,function(b){return j.warning("No está autorizado para entrar a esta vista","Restringido"),c.go("panel"),console.log("Evento notAuthorized: ",b,a.lastState)})}])}.call(this),function(){"use strict";angular.module("feryzApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(a,b,c,d,e){return e.translations("EN",{LOGIN_MSG:"Sign In to the panel"}).translations("ES",{LOGIN_MSG:"Ingresa al panel"})}])}.call(this),function(){"use strict";angular.module("feryzApp").controller("LoginCtrl",["$scope","$rootScope","AUTH_EVENTS","AuthService","$location","$cookies","Perfil","App","$state","cfpLoadingBar",function(a,b,c,d,e,f,g,h,i,j){a.logoPath="images/MyVc-1.gif",a.credentials={username:"",password:""},j.complete(),a.login=function(){var b;return b=d.login_credentials(a.credentials),b.then(function(a){i.go("panel")},function(a){return console.log("Promise de login_credentials rechazada",a)})}}])}.call(this),function(){"use strict";angular.module("feryzApp").config(["$stateProvider","App","USER_ROLES","$translateProvider",function(a,b,c,d){a.state("panel",{url:"/panel",views:{principal:{templateUrl:b.views+"panel/panel.tpl.html",controller:"PanelCtrl"}},resolve:{resolved_user:["AuthService",function(a){return a.verificar()}]},data:{pageTitle:"Feryz - Bienvenido",needed_roles:[c.administrador,c.vendedor,c.tecnico]}}),d.preferredLanguage("ES"),d.translations("EN",{INICIO_MENU:"Home",USERS_MENU:"Users",EVENTS_MENU:"Events",ENTIDADES_MENU:"Entities",CATEGS_MENU:"Categories",PREGUNTAS_MENU:"Questions",EVALUACIONES_MENU:"Tests",IDIOMA_MENU:"Language",INFORMES_MENU:"Reports",SALIR:"Sign out",ELIMINATORIAS:"Playoffs",GRAN_FINAL:"Great ultimate",INSCRITO_EN:"You are signed in:",NO_ESTAS_INSCRITO:"You are`t signed in any category.",EXAM_HECHOS:"Done Exams"}).translations("ES",{INICIO_MENU:"Inicio",EVENTS_MENU:"Eventos",ENTIDADES_MENU:"Entidades",CATEGS_MENU:"Categorías",PREGUNTAS_MENU:"Preguntas",EVALUACIONES_MENU:"Evaluaciones",USERS_MENU:"Usuarios",IDIOMA_MENU:"Idioma",INFORMES_MENU:"Informes",SALIR:"Salir",ELIMINATORIAS:"Eliminatorias",GRAN_FINAL:"Gran final",INSCRITO_EN:"Estás inscrito en:",NO_ESTAS_INSCRITO:"No estás inscrito en ninguna categoría.",EXAM_HECHOS:"Exámenes hechos"}).translations("PT",{INICIO_MENU:"Iniciação",EVENTS_MENU:"Eventos",ENTIDADES_MENU:"Entidades",CATEGS_MENU:"Categorias",PREGUNTAS_MENU:"Interrogatório",EVALUACIONES_MENU:"Evaluations",USERS_MENU:"Usuários",IDIOMA_MENU:"Língua",INFORMES_MENU:"Informação",SALIR:"Deixar",ELIMINATORIAS:"Playoffs",GRAN_FINAL:"Grande final",INSCRITO_EN:"Você está matriculado:",NO_ESTAS_INSCRITO:"Você não está registrado em qualquer categoria.",EXAM_HECHOS:"Testes feitos"})}])}.call(this),function(){"use strict";angular.module("feryzApp").controller("PanelCtrl",["$scope","$http","$state","$cookies","$rootScope","AuthService","Perfil","App","USER_ROLES","resolved_user","toastr","$translate","$filter","$uibModal","Fullscreen",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){a.USER=j,a.hasRole=f.hasRole,a.USER_ROLES=i,a.imagesPath=h.images+"perfil/",a.isAdmin=a.hasRole([i.administrador]),a.isVendedor=a.hasRole([i.vendedor]),a.isTecnico=a.hasRole([i.tecnico]),f.verificar_acceso(),e.$on("$stateChangeSuccess",function(b,c,d,e,f){return a.cambiarTema("theme-zero")}),a.openMenu=function(a,b){var c;return c=b,a(b)},a.gotoFilemanager=function(){return c.go("panel.filemanager")},a.gotoUsuarios=function(){return c.go("panel.usuarios")},a.set_user_event=function(c){return b.put("eventos/set-user-event",{evento_id:c.id}).then(function(b){return console.log("Evento cambiado: ",b),a.USER.evento_selected_id=c.id,a.el_evento_actual(),k.success("Evento actual cambiado por "+c.alias),e.$broadcast("cambio_evento_user")},function(a){return console.log("Error conectando!",a),k.warning("No se pudo cambiar el evento actual.")})},a.logout=function(){return f.logout(),b.put("login/logout").then(function(a){return console.log("Desconectado con éxito: ",a)},function(a){return console.log("Error desconectando!",a)})},a.setImagenPrincipal=function(){var b,c,d;return c=h.images+"perfil/",b=a.USER.image_nombre,d=c+b,a.imagenPrincipal=d},a.setImagenPrincipal(),a.$on("cambianImgs",function(b,c){return console.log(g.User()),a.USER=g.User(),a.setImagenPrincipal()}),a.setFullScreen=function(){return o.toggleAll()}}])}.call(this),function(){angular.module("feryzApp").config(["$stateProvider","App","USER_ROLES",function(a,b,c){return a.state("panel.usuarios",{url:"^/usuarios",views:{contenido_panel:{templateUrl:b.views+"usuarios/usuarios.tpl.html",controller:"UsuariosCtrl"}},data:{pageTitle:"Usuarios - Feryz",needed_roles:[c.administrador]}})}])}.call(this),function(){angular.module("feryzApp").controller("UsuariosCtrl",["$scope","$http","App","USER_ROLES","$filter","toastr","AuthService","$uibModal",function(a,b,c,d,e,f,g,h){var i,j;return g.verificar_acceso(),a.hasRole=g.hasRole,a.USER_ROLES=d,a.creando=!1,a.editando=!1,a.guardando=!1,a.usuarioActualizar={},a.tipos_doc=[{id:1,tipo:"Cédula"},{id:2,tipo:"Cédula extranjera"},{id:3,tipo:"Tarjeta de identidad"}],a.tipos_usuarios=[{id:1,tipo:"Administrador"},{id:2,tipo:"Vendedor"},{id:3,tipo:"Técnico"}],a.usuarioNuevo={sexo:"M",password:"",password_confirm:"",tipo_doc:{id:1,tipo:"Cédula"}},b.get("::paises/all").then(function(b){return a.paises=b.data,a.usuarioNuevo.pais=e("filter")(a.paises,{id:1})[0],a.usuarioNuevo.pais_doc=e("filter")(a.paises,{id:1})[0],a.paisSeleccionado(a.usuarioNuevo.pais),a.paisdocSeleccionado(a.usuarioNuevo.pais_doc)},function(){return f.error("No se pudo traer las ciudades.")}),a.paisSeleccionado=function(c,d){return b.get("::ciudades/departamentos",{params:{pais_id:c.id}}).then(function(b){return a.departamentos=b.data},function(){return f.error("No se pudo traer las ciudades.")})},a.paisdocSeleccionado=function(c,d){return b.get("::ciudades/departamentos",{params:{pais_id:c.id}}).then(function(b){return a.departamentos_doc=b.data},function(){return f.error("No se pudo traer las ciudades.")})},a.departamentoSeleccionado=function(c,d){return b.get("::ciudades/ciudades",{params:{departamento:c.departamento}}).then(function(b){return a.ciudades=b.data},function(){return f.error("No se pudo traer las ciudades.")})},a.departamentoDocSeleccionado=function(c,d){return b.get("::ciudades/ciudades",{params:{departamento:c.departamento}}).then(function(b){return a.ciudades_doc=b.data},function(){return f.error("No se pudo traer las ciudades.")})},a.crearUsuario=function(){return a.creando=!0,a.editando=!1},a.guardarUsuario=function(){return a.guardando=!0,a.usuarioNuevo.password!==a.usuarioNuevo.password_confirm?(f.warning("La contraseña y confirmación no coinciden"),a.guardando=!1,!1):a.usuarioNuevo.password.length<3?(f.warning("La contraseña debe tener al menos 3 caracteres"),a.guardando=!1,!1):b.post("::usuarios/guardar",a.usuarioNuevo).then(function(b){return a.opcionesGrid.data.push(b.data),f.success("Creado correctamente: "+b.data.nombres),a.creando=!1,a.guardando=!1},function(b){return a.guardando=!1,f.error("No se pudo crear usuario","Error")})},a.eliminarUsuario=function(b){var c;return c=h.open({templateUrl:"==usuarios/removeUsuario.tpl.html",controller:"RemoveUsuarioCtrl",resolve:{usuario:function(){return b}}}),c.result.then(function(b){return a.opcionesGrid.data=e("filter")(a.opcionesGrid.data,{id:"!"+b.id})})},a.actualizarUsuario=function(c){if(a.guardando=!0,""!==a.usuarioActualizar.password&&""!==a.usuarioActualizar.password_confirm){if(a.usuarioActualizar.password!==a.usuarioActualizar.password_confirm)return f.warning("La contraseña y confirmación no coinciden"),a.guardando=!1,!1;if(a.usuarioActualizar.password.length<3)return f.warning("La contraseña debe tener al menos 3 caracteres"),a.guardando=!1,!1}return b.put("::usuarios/actualizar",a.usuarioActualizar).then(function(b){return f.success("Actualizado correctamente: "+a.usuarioActualizar.nombres),a.editando=!1,a.guardando=!1,a.usuarioActualizar.anterior.tipo=a.usuarioActualizar.tipo.id,a.usuarioActualizar.anterior.tipo_doc=a.usuarioActualizar.tipo_doc.id},function(b){return a.guardando=!1,f.error("No se pudo actualizar","Error")})},a.editarUsuario=function(c){var d,f;return a.creando=!1,a.editando=!0,angular.copy(c,a.usuarioActualizar),a.usuarioActualizar.anterior=c,a.usuarioActualizar.password="",a.usuarioActualizar.password_confirm="",d=e("filter")(a.tipos_doc,{tipo:a.usuarioActualizar.tipo_doc},!0),d=d.length>0?d[0]:a.tipos_doc[0],a.usuarioActualizar.tipo_doc=d,f=e("filter")(a.tipos_usuarios,{tipo:a.usuarioActualizar.tipo},!0),f=f.length>0?f[0]:a.tipos_usuarios[0],a.usuarioActualizar.tipo=f,null===a.usuarioActualizar.ciudad_nac?(a.usuarioActualizar.pais={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisSeleccionado(a.usuarioActualizar.pais,a.usuarioActualizar.pais)):b.get("::ciudades/datosciudad/"+a.usuarioActualizar.ciudad_nac).then(function(b){return a.paises=b.data.paises,a.departamentosNac=b.data.departamentos,a.ciudadesNac=b.data.ciudades,a.usuarioActualizar.pais=b.data.pais,a.usuarioActualizar.depart_nac=b.data.departamento,a.usuarioActualizar.ciudad_nac=b.data.ciudad}),null===a.usuarioActualizar.ciudad_doc?(a.usuarioActualizar.pais_doc={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisSeleccionado(a.usuarioActualizar.pais_doc,a.usuarioActualizar.pais_doc)):b.get("::ciudades/datosciudad/"+a.usuarioActualizar.ciudad_doc).then(function(b){return a.paises=b.data.paises,a.departamentosNac=b.data.departamentos,a.ciudadesNac=b.data.ciudades,a.usuarioActualizar.pais_doc=b.data.pais,a.usuarioActualizar.depart_doc=b.data.departamento,a.usuarioActualizar.ciudad_doc=b.data.ciudad})},a.traerUsuarios=function(){return b.get("::usuarios/all").then(function(b){return a.opcionesGrid.data=b.data},function(a){return console.log("No se pudo traer los usuarios",a)})},a.traerUsuarios(),i='<a class="btn btn-default btn-xs" ng-click="grid.appScope.editarUsuario(row.entity)"><md-tooltip md-direction="left">Editar</md-tooltip><i class="fa fa-edit "></i>Modificar</a>',j='<a class="btn btn-default btn-xs" ng-click="grid.appScope.eliminarUsuario(row.entity)"><md-tooltip md-direction="left">Eliminar</md-tooltip><i class="fa fa-times "></i></a>',a.opcionesGrid={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enableCellEdit:a.isAdmin,enableCellEditOnFocus:!0,columnDefs:[{field:"id",width:60,enableCellEdit:!1},{field:"Edición",visible:a.isAdmin,cellTemplate:i+j,width:120,enableCellEdit:!1},{field:"nombres",minWidth:100},{field:"apellidos",minWidth:100},{field:"sexo",width:50},{field:"username",displayName:"Usuario"},{field:"email"},{field:"fecha_nac",type:"date",format:"yyyy-mm-dd"}],onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,e,g){return e!==g&&("sexo"===d.field?"M"===e||"F"===e?b.put("::usuarios/actualizar/"+c.id,c).then(function(a){return f.success("Usuario actualizado con éxito","Actualizado")},function(a){return f.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)}):(a.toastr.warning("Debe usar M o F"),c.sexo=g):b.put("::usuarios/actualizar/"+c.id,c).then(function(a){return f.success("Usuario actualizado con éxito","Actualizado")},function(a){return f.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)})),a.$apply()})}}}]).controller("RemoveUsuarioCtrl",["$scope","$uibModalInstance","usuario","$http","toastr",function(a,b,c,d,e){return a.usuario=c,a.ok=function(){return d["delete"]("::usuarios/destroy/"+c.id).then(function(a){return e.success("Usuario eliminado: "+c.nombres,"Eliminado")},function(a){return e.warning("Problema","No se pudo eliminar el usuario.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("feryzApp").config(["$stateProvider","App",function(a,b){return a.state("panel.proveedores",{url:"^/proveedores",views:{contenido_panel:{templateUrl:b.views+"proveedores_clientes/proveedores.tpl.html",controller:"ProveedoresCtrl"}},data:{pageTitle:"Proveedores - Feryz"}}),a.state("panel.clientes",{url:"^/clientes",views:{contenido_panel:{templateUrl:b.views+"proveedores_clientes/clientes.tpl.html",controller:"ClientesCtrl"}},data:{pageTitle:"Clientes - Feryz"}})}])}.call(this),function(){angular.module("feryzApp").controller("ProveedoresCtrl",["$scope","$http","App","$filter","toastr","AuthService","$uibModal",function(a,b,c,d,e,f,g){var h,i;return f.verificar_acceso(),a.creando=!1,a.editando=!1,a.guardando=!1,a.provActualizar={},a.provNuevo={sexo:"M",password:"",password_confirm:"",tipo_doc:{id:1,tipo:"Cédula"}},b.get("::paises/all").then(function(b){return a.paises=b.data,a.provNuevo.pais=d("filter")(a.paises,{id:1})[0],a.paisSeleccionado(a.provNuevo.pais)},function(){return e.error("No se pudo traer las ciudades.")}),a.paisSeleccionado=function(c,d){return b.get("::ciudades/departamentos",{params:{pais_id:c.id}}).then(function(b){return a.departamentos=b.data},function(){return e.error("No se pudo traer las ciudades.")})},a.departamentoSeleccionado=function(c,d){return b.get("::ciudades/ciudades",{params:{departamento:c.departamento}}).then(function(b){return a.ciudades=b.data},function(){return e.error("No se pudo traer las ciudades.")})},a.crearProveedor=function(){return a.creando=!0,a.editando=!1},a.guardarProveedor=function(){return a.guardando=!0,b.post("::proveedores/guardar",a.provNuevo).then(function(b){return a.opcionesGrid.data.push(b.data),e.success("Creado correctamente: "+b.data.nombre),a.creando=!1,a.guardando=!1},function(b){return a.guardando=!1,e.error("No se pudo crear proveedor","Error")})},a.eliminarProveedor=function(b){var c;return c=g.open({templateUrl:"==proveedores_clientes/removeProveedor.tpl.html",controller:"RemoveProveedorCtrl",resolve:{proveedor:function(){return b}}}),c.result.then(function(b){return a.opcionesGrid.data=d("filter")(a.opcionesGrid.data,{id:"!"+b.id})})},a.actualizarProveedor=function(c){return a.guardando=!0,b.put("::proveedores/actualizar",a.provActualizar).then(function(b){return e.success("Actualizado correctamente: "+a.provActualizar.nombre),a.editando=!1,a.guardando=!1},function(b){return a.guardando=!1,e.error("No se pudo actualizar","Error")})},a.editarProveedor=function(c){return a.creando=!1,a.editando=!0,angular.copy(c,a.provActualizar),a.provActualizar.anterior=c,null===a.provActualizar.ciudad_id?(a.provActualizar.pais={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisSeleccionado(a.provActualizar.pais,a.provActualizar.pais)):b.get("::ciudades/datosciudad/"+a.provActualizar.ciudad_id).then(function(b){return a.paises=b.data.paises,a.departamentos=b.data.departamentos,a.ciudades=b.data.ciudades,a.provActualizar.pais=b.data.pais,a.provActualizar.departamento=b.data.departamento,a.provActualizar.ciudad=b.data.ciudad})},a.traerProveedores=function(){return b.get("::proveedores/all").then(function(b){return a.opcionesGrid.data=b.data},function(a){return console.log("No se pudo traer los proveedores",a)})},a.traerProveedores(),h='<a class="btn btn-default btn-xs" ng-click="grid.appScope.editarProveedor(row.entity)"><md-tooltip md-direction="left">Editar</md-tooltip><i class="fa fa-edit "></i>Modificar</a>',i='<a class="btn btn-default btn-xs" ng-click="grid.appScope.eliminarProveedor(row.entity)"><md-tooltip md-direction="left">Eliminar</md-tooltip><i class="fa fa-times "></i></a>',a.opcionesGrid={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enableCellEdit:a.isAdmin,enableCellEditOnFocus:!0,columnDefs:[{field:"id",width:60,enableCellEdit:!1},{field:"Edición",visible:a.isAdmin,cellTemplate:h+i,width:120,enableCellEdit:!1},{field:"nombre",minWidth:100},{field:"direccion",displayName:"Dirección",minWidth:100},{field:"persona_contacto",displayName:"Persona contacto",minWidth:100},{field:"email"},{field:"telefono1"}],onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,f,g){return f!==g&&b.put("::proveedores/actualizar/"+c.id,c).then(function(a){return e.success("Proveedor actualizado con éxito","Actualizado")},function(a){return e.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)}),a.$apply()})}}}]).controller("RemoveProveedorCtrl",["$scope","$uibModalInstance","proveedor","$http","toastr",function(a,b,c,d,e){return a.proveedor=c,a.ok=function(){return d["delete"]("::proveedores/destroy/"+c.id).then(function(a){return e.success("Proveedor eliminado: "+c.nombre,"Eliminado")},function(a){return e.warning("Problema","No se pudo eliminar el proveedor.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("feryzApp").controller("ClientesCtrl",["$scope","$http","App","$filter","toastr","AuthService","$uibModal",function(a,b,c,d,e,f,g){var h,i;return f.verificar_acceso(),a.creando=!1,a.editando=!1,a.guardando=!1,a.clieActualizar={},a.clieNuevo={sexo:"M",password:"",password_confirm:"",tipo_doc:{id:1,tipo:"Cédula"}},b.get("::paises/all").then(function(b){return a.paises=b.data,a.clieNuevo.pais=d("filter")(a.paises,{id:1})[0],a.paisSeleccionado(a.clieNuevo.pais)},function(){return e.error("No se pudo traer las ciudades.")}),a.paisSeleccionado=function(c,d){return b.get("::ciudades/departamentos",{params:{pais_id:c.id}}).then(function(b){return a.departamentos=b.data},function(){return e.error("No se pudo traer las ciudades.")})},a.departamentoSeleccionado=function(c,d){return b.get("::ciudades/ciudades",{params:{departamento:c.departamento}}).then(function(b){return a.ciudades=b.data},function(){return e.error("No se pudo traer las ciudades.")})},a.crearCliente=function(){return a.creando=!0,a.editando=!1},a.guardarCliente=function(){return a.guardando=!0,b.post("::clientes/guardar",a.clieNuevo).then(function(b){return a.opcionesGrid.data.push(b.data),e.success("Creado correctamente: "+b.data.nombre),a.creando=!1,a.guardando=!1},function(b){return a.guardando=!1,e.error("No se pudo crear Cliente","Error")})},a.eliminarCliente=function(b){var c;return c=g.open({templateUrl:"==proveedores_clientes/removeCliente.tpl.html",controller:"RemoveClienteCtrl",resolve:{cliente:function(){return b}}}),c.result.then(function(b){return a.opcionesGrid.data=d("filter")(a.opcionesGrid.data,{id:"!"+b.id})})},a.actualizarCliente=function(c){return a.guardando=!0,b.put("::clientes/actualizar",a.clieActualizar).then(function(b){return e.success("Actualizado correctamente: "+a.clieActualizar.nombre),a.editando=!1,a.guardando=!1},function(b){return a.guardando=!1,e.error("No se pudo actualizar","Error")})},a.editarCliente=function(c){return a.creando=!1,a.editando=!0,angular.copy(c,a.clieActualizar),a.clieActualizar.anterior=c,null===a.clieActualizar.ciudad_id?(a.clieActualizar.pais={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisSeleccionado(a.clieActualizar.pais,a.clieActualizar.pais)):b.get("::ciudades/datosciudad/"+a.clieActualizar.ciudad_id).then(function(b){return a.paises=b.data.paises,a.departamentos=b.data.departamentos,a.ciudades=b.data.ciudades,a.clieActualizar.pais=b.data.pais,a.clieActualizar.departamento=b.data.departamento,a.clieActualizar.ciudad=b.data.ciudad})},a.traerClientes=function(){return b.get("::clientes/all").then(function(b){return a.opcionesGrid.data=b.data},function(a){return console.log("No se pudo traer los clientes",a)})},a.traerClientes(),h='<a class="btn btn-default btn-xs" ng-click="grid.appScope.editarCliente(row.entity)"><md-tooltip md-direction="left">Editar</md-tooltip><i class="fa fa-edit "></i>Modificar</a>',i='<a class="btn btn-default btn-xs" ng-click="grid.appScope.eliminarCliente(row.entity)"><md-tooltip md-direction="left">Eliminar</md-tooltip><i class="fa fa-times "></i></a>',a.opcionesGrid={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enableCellEdit:a.isAdmin,enableCellEditOnFocus:!0,columnDefs:[{field:"id",width:60,enableCellEdit:!1},{field:"Edición",visible:a.isAdmin,cellTemplate:h+i,width:120,enableCellEdit:!1},{field:"nombre",minWidth:100},{field:"direccion",displayName:"Dirección",minWidth:100},{field:"persona_contacto",displayName:"Persona contacto",minWidth:100},{field:"email"},{field:"telefono1"}],onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,f,g){return f!==g&&b.put("::clientes/actualizar/"+c.id,c).then(function(a){return e.success("Cliente actualizado con éxito","Actualizado")},function(a){return e.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)}),a.$apply()})}}}]).controller("RemoveClienteCtrl",["$scope","$uibModalInstance","cliente","$http","toastr",function(a,b,c,d,e){return a.cliente=c,a.ok=function(){return d["delete"]("::clientes/destroy/"+c.id).then(function(a){return e.success("Cliente eliminado: "+c.nombre,"Eliminado")},function(a){return e.warning("Problema","No se pudo eliminar el cliente.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("feryzApp").config(["$stateProvider","App",function(a,b){return a.state("panel.productos",{url:"^/productos",views:{contenido_panel:{templateUrl:b.views+"productos/productos.tpl.html",controller:"ProductosCtrl"}},data:{pageTitle:"Productos - Feryz"}}),a.state("panel.categorias",{url:"^/categorias",views:{contenido_panel:{templateUrl:b.views+"productos/categorias.tpl.html",controller:"CategoriasCtrl"}},data:{pageTitle:"Categorías - Feryz"}})}])}.call(this),function(){angular.module("feryzApp").controller("ProductosCtrl",["$scope","$http","App","USER_ROLES","$filter","toastr","AuthService","$uibModal","$timeout","$q","removeAccents",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p;return g.verificar_acceso(),a.hasRole=g.hasRole,a.USER_ROLES=d,a.USER=a.USER,l=a.USER,a.creando=!1,a.editando=!1,a.guardando=!1,a.prodActualizar={},a.unidades=[{unidad:"-"},{unidad:"metros"},{unidad:"rollos"}],a.categorias=[],a.prodNuevo={unidad_medida:{unidad:"-"},iva:0,activo:1,cantidad_minima:5},a.bc={format:"CODE128",lineColor:"#000000",width:2,height:70,displayValue:!0,fontOptions:"",font:"monospace",textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",margin:0,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(a){}},p=["3.00","9.5","19"],a.crearProducto=function(){return a.creando=!0,a.editando=!1,i(function(){return a.focusOnNuevo=!0})},a.guardarProducto=function(){return a.guardando=!0,b.post("::productos/guardar",a.prodNuevo).then(function(b){return a.opcionesGrid.data.push(b.data),f.success("Creado correctamente: "+b.data.nombre),a.creando=!1,a.guardando=!1},function(b){return a.guardando=!1,f.error("No se pudo crear Producto","Error")})},a.eliminarProducto=function(b){var c;return c=h.open({templateUrl:"==productos/removeProducto.tpl.html",controller:"RemoveProductoCtrl",resolve:{Producto:function(){return b}}}),c.result.then(function(b){return a.opcionesGrid.data=e("filter")(a.opcionesGrid.data,{id:"!"+b.id})})},a.actualizarProducto=function(c){return a.guardando=!0,b.put("::productos/actualizar",a.prodActualizar).then(function(b){return f.success("Actualizado correctamente: "+a.prodActualizar.nombre),a.editando=!1,a.guardando=!1},function(b){return a.guardando=!1,f.error("No se pudo actualizar","Error")})},a.editarProducto=function(b){var c,d;return a.creando=!1,a.editando=!0,angular.copy(b,a.prodActualizar),a.prodActualizar.anterior=b,c=e("filter")(a.categorias,{id:a.prodActualizar.categoria_id},!0)[0],a.prodActualizar.categoria=c,d=e("filter")(a.unidades,{unidad:a.prodActualizar.unidad_medida},!0)[0],a.prodActualizar.unidad_medida=d,i(function(){return a.focusOnEdit=!0},100)},a.resultProductos=function(b){var c,d,f;return c=j.defer(),k.search=b,f=e("filter")(a.opcionesGrid.data,k.ignoreAccents),c.resolve(f),d=c.promise},a.traerDatos=function(){return b.put("::productos/datos").then(function(b){return b=b.data,a.opcionesGrid.data=b.productos,a.categorias=b.categorias,a.codigos_barras=b.codigos_barras,a.opcionesGrid.columnDefs[3].editDropdownOptionsArray=a.categorias},function(a){return console.log("No se pudo traer los datos",a)})},a.traerDatos(),console.log(l.deci_salida),m='<span class="btn-group"><a class="btn btn-default btn-xs" ng-click="grid.appScope.editarProducto(row.entity)"><md-tooltip md-direction="left">Editar</md-tooltip><i class="fa fa-edit "></i>Edit</a>',n='<a class="btn btn-danger btn-xs" ng-click="grid.appScope.eliminarProducto(row.entity)"><md-tooltip md-direction="left">Eliminar</md-tooltip><i class="fa fa-times "></i></a><span>',o='<div><form name="inputForm"><input ui-percentage-mask="0" ui-percentage-value type="INPUT_TYPE" ng-class="\'colt\' + col.uid" ui-grid-editor ng-model="MODEL_COL_FIELD" /></form</div>',a.opcionesGrid={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,exporterSuppressColumns:["Edición"],exporterCsvColumnSeparator:";",exporterMenuPdf:!1,exporterMenuExcel:!1,exporterCsvFilename:"Productos - Feryz.csv",enableGridMenu:!0,enableCellEdit:a.isAdmin,enableCellEditOnFocus:!0,columnDefs:[{field:"id",width:60,enableCellEdit:!1},{field:"Edición",visible:a.isAdmin,cellTemplate:m+n,width:90,enableCellEdit:!1,enableFiltering:!1},{field:"nombre",minWidth:270},{field:"categoria_id",displayName:"Categoría",minWidth:105,cellFilter:"mapCategorias:grid.appScope.categorias",filter:{condition:function(b,c){var d,f;return f=e("filter")(a.categorias,{nombre:b}),d=e("filter")(f,{id:c},!0),d.length>0}},editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"nombre",enableCellEditOnFocus:!0},{field:"cantidad_minima",displayName:"Min",cellFilter:"number"},{field:"iva",minWidth:50,cellTemplate:'<div class="ui-grid-cell-contents">{{row.entity.iva | number:0}}%</div>',editableCellTemplate:o},{field:"activo",type:"boolean",width:60,cellTemplate:'<input type="checkbox" ng-model="row.entity.activo" ng-true-value="1" ng-false-value="0" ng-change="grid.appScope.guardarToggleActivo(row.entity)" ng-disabled="!grid.appScope.isAdmin" style="width: 50px;height: 18px;">'},{field:"precio_venta",displayName:"Prec venta",cellFilter:"currency:undefined:grid.appScope.USER.deci_salida",minWidth:90}],exporterFieldCallback:function(b,c,d,f){var g;return"categoria_id"===d.name?(g=e("filter")(a.categorias,{id:f
},!0)[0],g?g.nombre:""):"activo"===d.name?f?"Si":"No":f},onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,e,g){return e!==g&&b.put("::productos/actualizar",c).then(function(a){return f.success("Producto actualizado con éxito","Actualizado")},function(a){return f.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)}),a.$apply()})}},a.guardarToggleActivo=function(c){return a.isAdmin?b.put("::productos/actualizar",c).then(function(a){return f.success("Producto actualizado con éxito","Actualizado")},function(a){return f.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)}):f.warning("No tienes permiso para modificar productos","Lo sentimos")}}]).controller("RemoveProductoCtrl",["$scope","$uibModalInstance","Producto","$http","toastr",function(a,b,c,d,e){return a.Producto=c,a.ok=function(){return d["delete"]("::productos/destroy/"+c.id).then(function(a){return e.success("Producto eliminado: "+c.nombre,"Eliminado")},function(a){return e.warning("Problema","No se pudo eliminar el Producto.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).filter("mapCategorias",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b},!0)[0],d?d.nombre:"En papelera..."):"Elija..."}}]).filter("porcentaje",["$filter",function(a){return function(b,c){return a("number")(100*b,c)+"%"}}])}.call(this),function(){angular.module("feryzApp").controller("CategoriasCtrl",["$scope","$http","App","$filter","toastr","AuthService","$uibModal",function(a,b,c,d,e,f,g){var h,i;return f.verificar_acceso(),a.creando=!1,a.editando=!1,a.guardando=!1,a.cateActualizar={},a.cateNuevo={},a.crearCategoria=function(){return a.creando=!0,a.editando=!1},a.guardarCategoria=function(){return a.guardando=!0,b.post("::categorias/guardar",a.cateNuevo).then(function(b){return a.opcionesGrid.data.push(b.data),e.success("Creado correctamente: "+b.data.nombre),a.creando=!1,a.guardando=!1},function(b){return a.guardando=!1,e.error("No se pudo crear categoría","Error")})},a.eliminarCategoria=function(b){var c;return c=g.open({templateUrl:"==productos/removeCategoria.tpl.html",controller:"RemoveCategoriaCtrl",resolve:{categoria:function(){return b}}}),c.result.then(function(b){return a.opcionesGrid.data=d("filter")(a.opcionesGrid.data,{id:"!"+b.id})})},a.actualizarCategoria=function(c){return a.guardando=!0,b.put("::categorias/actualizar",a.cateActualizar).then(function(b){return e.success("Actualizado correctamente: "+a.cateActualizar.nombre),a.editando=!1,a.guardando=!1},function(b){return a.guardando=!1,e.error("No se pudo actualizar","Error")})},a.editarCategoria=function(b){return a.creando=!1,a.editando=!0,angular.copy(b,a.cateActualizar),a.cateActualizar.anterior=b},a.traerCategorias=function(){return b.get("::categorias/all").then(function(b){return a.opcionesGrid.data=b.data},function(a){return console.log("No se pudo traer los categorías",a)})},a.traerCategorias(),h='<a class="btn btn-default btn-xs" ng-click="grid.appScope.editarCategoria(row.entity)"><md-tooltip md-direction="left">Editar</md-tooltip><i class="fa fa-edit "></i>Modificar</a>',i='<a class="btn btn-default btn-xs" ng-click="grid.appScope.eliminarCategoria(row.entity)"><md-tooltip md-direction="left">Eliminar</md-tooltip><i class="fa fa-times "></i></a>',a.opcionesGrid={showGridFooter:!0,enableSorting:!0,enableFiltering:!0,enableCellEdit:a.isAdmin,enableCellEditOnFocus:!0,columnDefs:[{field:"id",width:60,enableCellEdit:!1},{field:"Edición",visible:a.isAdmin,enableFiltering:!1,cellTemplate:h+i,width:120,enableCellEdit:!1},{field:"nombre",minWidth:100}],onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,f,g){return f!==g&&b.put("::categorias/actualizar/"+c.id,c).then(function(a){return e.success("categoria actualizado con éxito","Actualizado")},function(a){return e.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)}),a.$apply()})}}}]).controller("RemoveCategoriaCtrl",["$scope","$uibModalInstance","categoria","$http","toastr",function(a,b,c,d,e){return a.categoria=c,a.ok=function(){return d["delete"]("::categorias/destroy/"+c.id).then(function(a){return e.success("Categoría eliminado: "+c.nombre,"Eliminado")},function(a){return e.warning("Problema","No se pudo eliminar el categoria.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("feryzApp").config(["$stateProvider","App",function(a,b){return a.state("panel.entradas",{url:"^/entradas",views:{contenido_panel:{templateUrl:b.views+"entradas/entradas.tpl.html",controller:"EntradasCtrl"}},data:{pageTitle:"Entradas - Feryz",hotkeys:[["n","Nueva entrada","nuevaEntrada()"]]}})}])}.call(this),function(){angular.module("feryzApp").controller("EntradasCtrl",["$scope","$http","App","USER_ROLES","$filter","toastr","AuthService","$uibModal","$timeout","Local","hotkeys",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p;return g.verificar_acceso(),a.hasRole=g.hasRole,a.USER_ROLES=d,a.USER=a.USER,l=a.USER,a.creando=!1,a.editando=!1,a.guardando=!1,a.prodActualizar={},a.conIva=!0,a.altura=400,a.focusOnConSinIva=!1,a.mostrarPrecioVentaConIva=!0,a.entradaNueva={fecha:new Date,proveedor:void 0,productos_agregados:[]},a.entradaNuevaT={fecha:new Date,proveedor:void 0,productos_agregados:[]},a.detalle={precio_venta:0,precio_costo:0,cantidad:1,iva:0,codigo_barras:void 0},a.detalleT={precio_venta:0,precio_costo:0,cantidad:1,iva:0,codigo_barras:void 0},a.EntSinGuardar=[],a.indiceEnt=0,a.data={},a.dateOptions={formatYear:"yy"},a.ocultarNav(),a.productos=[],a.proveedores=[],a.categorias=[],a.codigos_barras=[],a.mostrandoEntrada=!1,a.traerDatos=function(){return b.put("::entradas/datos").then(function(b){return b=b.data,a.productos=b.productos,a.proveedores=b.proveedores,a.categorias=b.categorias,a.codigos_barras=b.codigos_barras,a.opcionesGrid.columnDefs[3].editDropdownOptionsArray=a.proveedores},function(a){return f.error("Error trayendo los datos."),console.log("No se pudo traer los datos",a)})},a.traerDatos(),p=function(){return j.getEntradasSinGuardar().then(function(b){var c,d,e,f;if(b.length>0){for(a.EntSinGuardar=b,console.log(a.EntSinGuardar),f=a.EntSinGuardar,d=0,e=f.length;e>d;d++)c=f[d],c.fecha=new Date(c.fecha+" 00:00:00");return a.setEntradaSinGuardar(a.EntSinGuardar.length-1)}return j.insertEntrada().then(function(a){return p()},function(a){return console.log(a)})},function(a){return console.log(a,"pailas")})},p(),a.nuevaEntrada=function(){return j.insertEntrada().then(function(b){return b.fecha=new Date(b.fecha+" 00:00:00"),a.EntSinGuardar.push(b),a.setEntradaSinGuardar(a.EntSinGuardar.length-1)},function(a){return console.log(a)})},a.descartarEntrada=function(b,c,d){var e;return("undefined"===d||void 0===d)&&(d=a.EntSinGuardar[a.indiceEnt]),e=!0,d.productos_agregados.length>0&&(e=confirm("¿Seguro quiere descartar esta entrada?")),e?j.deleteEntrada(d.rowid).then(function(b){return d.descartada=!0,a.setEntradaSinGuardar()},function(a){return console.log(a)}):void 0},a.setEntradaSinGuardar=function(b){return 0===b||b>0?a.indiceEnt=b:(a.indiceEnt++,a.indiceEnt>a.EntSinGuardar.length-1&&(a.indiceEnt=0)),a.entradaNueva=a.EntSinGuardar[a.indiceEnt],a.opcionesGrid.data=a.entradaNueva.productos_agregados,console.log(a.entradaNueva)},k.bindTo(a).add({combo:"n",description:"Nueva transacción de Entrada",callback:a.nuevaEntrada}).add({combo:"f2",description:"Ir a la siguiente Entrada",callback:a.setEntradaSinGuardar}).add({combo:"esc",description:"Salir de input",allowIn:["INPUT","SELECT","TEXTAREA"],callback:function(a,b){return angular.element("#focusOnConSinIva").trigger("focus")}}).add({combo:"ctrl+d",description:"Descartar entrada",allowIn:["INPUT","SELECT","TEXTAREA"],callback:a.descartarEntrada}),a.totalDetalle=function(b){var c,d;return b?(b=!1,0):(d=a.detalle.cantidad*a.detalle.precio_costo,c=e("currency")(d,void 0,l.deci_total))},a.totalDetalle(!0),a.totalEntrada=function(a){var b,c,d,f,g,h,i,j,k;for(i=0,h=0,d=0,f=a.length;f>d;d++)c=a[d],g=c.entity.precio_entrada,i+=c.entity.cantidad*g,h+=c.entity.cantidad*(g+g*(c.entity.iva/100));return k=e("currency")(i,void 0,l.deci_total),j=e("currency")(h,void 0,l.deci_total),b="Tot Iva: "+j+" - Sin Iva: "+k},a.totalEntradaValue=function(b){var c,d,f,g,h,i;if(b){for(h=0,d=0,f=b.length;f>d;d++)c=b[d],g=c.precio_costo,a.conIva&&(g=c.precio_costo+c.precio_costo*(c.iva/100)),h+=c.cantidad*g;return i=e("currency")(h,void 0,l.deci_total)}return 0},a.toggleConIva=function(){return a.conIva=!a.conIva},a.proveedorSeleccionado=function(b,c){return b?a.$broadcast("focusOnCodigoBarras"):void 0},a.codigoBarrasSeleccionado=function(b,c){var d;return b?(i(function(){return a.focusOnPrecioCosto=!0},100),d=e("filter")(a.productos,{id:b.id},!0),d.length>0&&(a.detalle.producto=d[0],a.detalle.nombre=a.detalle.producto.nombre,a.detalle.producto_id=b.id),b.iva?a.detalle.iva=b.iva:0===b.iva?a.detalle.iva=b.iva:void 0):a.detalle.producto=void 0},a.productoSeleccionado=function(b,c){var d;return b?(a.detalle.nombre=a.detalle.producto.nombre,a.detalle.producto_id=b.id,i(function(){return a.focusOnPrecioCosto=!0},100),d=e("filter")(a.codigos_barras,{id:b.id},!0),d.length>0?a.detalle.codigo_barras=d[0]:a.detalle.codigo_barras=void 0,b.iva?a.detalle.iva=b.iva:0===b.iva?a.detalle.iva=b.iva:void 0):a.detalle.codigo_barras=void 0},a.clickPrecioVentaConIva=function(b){return a.mostrarPrecioVentaConIva=!1,a.detalle.precio_venta=b,i(function(){return a.focusOnPrecioVenta=!0}),i(function(){return a.mostrarPrecioVentaConIva=!0},1e3)},a.agregarProducto=function(){var b;return a.detalle.producto?(a.agregando_producto=!0,b={},angular.copy(a.detalle,b),a.entradaNueva.productos_agregados.push(b),a.opcionesGrid.data=a.entradaNueva.productos_agregados,a.detalleT.producto_id=a.detalle.producto.id,angular.copy(a.detalleT,a.detalle),a.agregando_producto=!1,a.entradaNueva.productos_agregados.length>10?a.altura=600:void 0):(f.warning("Debe elegir un producto"),a.agregando_producto=!1)},a.quitarProducto=function(b){return a.entradaNueva.productos_agregados=e("filter")(a.entradaNueva.productos_agregados,{producto_id:"!"+b.producto_id}),a.opcionesGrid.data=a.entradaNueva.productos_agregados,a.entradaNueva.productos_agregados.length<11?a.altura=400:void 0},a.guardarEntradas=function(){return a.entradasNueva.proveedor?b.post("::entradas/guardar",{productos:a.entradaNueva.productos_agregados,compra:a.compraNueva}).then(function(a){return f.success("Guardada")},function(a){return f.error("No se pudo guardar la entrada")}):f.warning("Debes elegir el proveedor")},m='<span class="btn-group"><a class="btn btn-default btn-xs" ng-click="grid.appScope.editarProducto(row.entity)"><md-tooltip md-direction="left">Editar</md-tooltip><i class="fa fa-edit "></i>Edit</a>',n='<a class="btn btn-danger btn-xs" ng-click="grid.appScope.quitarProducto(row.entity)"><md-tooltip md-direction="left">Quitar</md-tooltip><i class="fa fa-times "></i></a><span>',o='<div><form name="inputForm"><input ui-percentage-mask="0" ui-percentage-value type="INPUT_TYPE" ng-class="\'colt\' + col.uid" ui-grid-editor ng-model="MODEL_COL_FIELD" /></form</div>',a.opcionesGrid={showGridFooter:!0,enableSorting:!1,enableColumnMenus:!1,enableFiltering:!0,enableCellEdit:!0,enableCellEditOnFocus:!0,gridFooterTemplate:'<div class="ui-grid-footer-info ui-grid-grid-footer row"><span class="col-lg-4 col-sm-4">Productos: {{grid.rows.length}}<span ng-if="grid.renderContainers.body.visibleRowCache.length !== grid.rows.length" class="ngLabel"> (mostrando {{grid.renderContainers.body.visibleRowCache.length}})</span></span>   <span class="col-lg-8 col-sm-8 formato-total">{{grid.appScope.totalCompra(grid.rows)}}</span></div>',columnDefs:[{field:"No",width:60,enableCellEdit:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{rowRenderIndex + 1}}</div>'},{field:"Ed",displayName:"",cellTemplate:n,width:35,enableCellEdit:!1,enableFiltering:!1},{field:"nombre",displayName:"Producto",minWidth:270},{field:"iva",type:"text",cellTemplate:'<div class="ui-grid-cell-contents">{{row.entity.iva | number:0}}%</div>',editableCellTemplate:o,width:50},{field:"precio_costo",displayName:"$Costo",cellFilter:"currency:undefined:grid.appScope.USER.deci_entrada",cellClass:"grid-align-right",minWidth:80},{field:"precio_venta",displayName:"$Venta",cellFilter:"currency:undefined:grid.appScope.USER.deci_salida",cellClass:"grid-align-right",minWidth:70},{field:"cantidad",displayName:"Cant",enableSorting:!0,cellFilter:"number",minWidth:50,maxWidth:70},{displayName:"Total",name:"Total",enableSorting:!0,enableCellEdit:!1,cellFilter:"number",minWidth:100,cellTemplate:'<div class="ui-grid-cell-contents" style="text-align: right">{{row.entity.precio_costo * row.entity.cantidad | currency:undefined:grid.appScope.USER.deci_total}}</div>'}],onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,e,g){return e!==g&&"nombre"===d.field&&b.put("::productos/actualizar-nombre",{producto_id:c.producto.id,nombre:c.nombre}).then(function(a){return f.success("Nombre de Producto actualizado","Actualizado")},function(a){return f.error("Cambio no guardado","Error")}),a.$apply()})}},a.guardarToggleActivo=function(a){return b.put("::productos/actualizar/"+a.id,a).then(function(a){return f.success("Producto actualizado con éxito","Actualizado")},function(a){return f.error("Cambio no guardado","Error"),console.log("Falló al intentar guardar: ",a)})},a.gridEntradas={showGridFooter:!0,enableSorting:!1,enableColumnMenus:!1,enableFiltering:!0,enableCellEdit:!0,enableCellEditOnFocus:!0,gridFooterTemplate:'<div class="ui-grid-footer-info ui-grid-grid-footer row"><span class="col-lg-4 col-sm-4">Productos: {{grid.rows.length}}<span ng-if="grid.renderContainers.body.visibleRowCache.length !== grid.rows.length" class="ngLabel"> (mostrando {{grid.renderContainers.body.visibleRowCache.length}})</span></span>   <span class="col-lg-8 col-sm-8 formato-total">{{grid.appScope.totalEntrada(grid.rows)}}</span></div>',columnDefs:[{field:"id",width:60,enableCellEdit:!1},{field:"Ed",displayName:"",cellTemplate:n,width:35,enableCellEdit:!1,enableFiltering:!1},{field:"fecha"},{field:"proveedor_id"},{field:"created_by",displayName:"Creado por"},{field:"created_at",displayName:"Creado en"}],onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,e,g){return e!==g&&"nombre"===d.field&&b.put("::productos/actualizar-nombre",{producto_id:c.producto.id,nombre:c.nombre}).then(function(a){return f.success("Nombre de Producto actualizado","Actualizado")},function(a){return f.error("Cambio no guardado","Error")}),a.$apply()})}},a.mostrarEntradas=function(){return b.put("::entradas/all").then(function(b){return a.gridEntradas.data=b.data.entradas,a.mostrandoEntradas=!0},function(a){return f.error("No se pudo traer las Entradas")})},a.ocultarEntradas=function(){return a.mostrandoEntradas=!1}}]).controller("RemoveEntradaCtrl",["$scope","$uibModalInstance","Producto","$http","toastr",function(a,b,c,d,e){return a.Producto=c,a.ok=function(){return d["delete"]("::productos/destroy/"+c.id).then(function(a){return e.success("Producto eliminado: "+c.nombre,"Eliminado")},function(a){return e.warning("Problema","No se pudo eliminar el Producto.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}]).filter("mapProveedores",["$filter",function(a){return function(b,c){var d;return b?(d=a("filter")(c,{id:b},!0)[0],d?d.nombre:"En papelera..."):"Elija..."}}])}.call(this),function(){"use strict";angular.module("feryzApp").config(["$stateProvider","App","USER_ROLES","PERMISSIONS","$translateProvider",function(a,b,c,d,e){a.state("panel.informes",{url:"^/informes/",views:{contenido_panel:{templateUrl:"==informes/informes.tpl.html",controller:"InformesCtrl"}},data:{pageTitle:"Informes"}}).state("panel.informes.ver_usuarios",{url:"ver_usuarios",views:{report_content:{templateUrl:"==informes/verUsuarios.tpl.html",controller:"VerUsuariosCtrl",resolve:{usuarios:["$http","$stateParams",function(a,b){return a.get("::usuarios/all")}]}}},data:{pageTitle:"Usuarios - Feryz"}}).state("panel.informes.ver_productos",{url:"ver_productos",views:{report_content:{templateUrl:"==informes/verProductos.tpl.html",controller:"VerProductosCtrl",resolve:{productos:["$http","$stateParams",function(a,b){return a.get("::productos/all")}]}}},data:{pageTitle:"Productos - Feryz"}}).state("panel.informes.ver_proveedores",{url:"ver_proveedores",views:{report_content:{templateUrl:"==informes/verProveedores.tpl.html",controller:"VerProveedoresCtrl",resolve:{proveedores:["$http","$stateParams",function(a,b){return a.get("::proveedores/all")}]}}},data:{pageTitle:"Proveedores - Feryz"}})}])}.call(this),function(){"use strict";angular.module("feryzApp").controller("InformesCtrl",["$scope","$http","$state","$cookies","$rootScope","toastr","$filter",function(a,b,c,d,e,f,g){var h;return a.config={},a.verProductos=function(){return c.go("panel.informes.ver_productos",{},{reload:!0})},a.verProveedores=function(){return c.go("panel.informes.ver_proveedores",{},{reload:!0})},a.verUsuarios=function(){return c.go("panel.informes.ver_usuarios",{},{reload:!0})},a.$on("cambia_descripcion",function(b,c){return a.descripcion_informe=c}),d.get("config")?(h=d.get("config"),a.config=JSON.parse(h),a.informe_tab_productos="productos"===a.config.informe_tab_actual?!0:!1):a.config.orientacion="vertical",a.$watch("config",function(b,c){return d.put("config",JSON.stringify(b)),a.$broadcast("change_config")},!0),a.tabSeleccionado=function(b){return console.log(a.config),a.config.informe_tab_actual=b,d.put("config",JSON.stringify(a.config))}}])}.call(this),function(){"use strict";angular.module("feryzApp").controller("VerUsuariosCtrl",["$scope","$http","$state","$cookies","$rootScope","toastr","$filter","usuarios",function(a,b,c,d,e,f,g,h){return a.usuarios=h.data}])}.call(this),function(){"use strict";angular.module("feryzApp").controller("VerProductosCtrl",["$scope","$http","$state","$cookies","$rootScope","toastr","$filter","productos",function(a,b,c,d,e,f,g,h){return a.productos=h.data}])}.call(this),function(){"use strict";angular.module("feryzApp").controller("VerProveedoresCtrl",["$scope","$http","$state","$cookies","$rootScope","toastr","$filter","proveedores",function(a,b,c,d,e,f,g,h){return a.proveedores=h.data,console.log(a.proveedores)}])}.call(this),function(){angular.module("feryzApp").config(["$stateProvider","App",function(a,b){return a.state("panel.ciudades",{url:"^/ciudades",views:{contenido_panel:{templateUrl:"==ciudades/ciudades.tpl.html",controller:"CiudadesCtrl"}}})}])}.call(this),function(){angular.module("feryzApp").controller("CiudadesCtrl",["$scope","$http","App","$filter","toastr",function(a,b,c,d,e){return a.creandociudad=!1,a.creandodepartamento=!1,a.creandopais=!1,a.crearciudad={nuevo_depart:!1},a.modificando_depart=!1,a.crearpais={},a.hola=!1,b.get("::paises/all").then(function(b){return a.paises=b.data,a.crearciudad.pais=d("filter")(a.paises,{id:1})[0],a.paisSeleccionado(a.crearciudad.pais)},function(){return e.error("No se pudo traer las ciudades.")}),a.paisSeleccionado=function(c,f){return b.get("::ciudades/departamentos",{params:{pais_id:c.id}}).then(function(b){return a.departamentos=b.data,a.modificando_depart?(a.crearciudad.depart=d("filter")(a.departamentos,{departamento:f},!0)[0],a.departamentoSeleccionado(a.crearciudad.depart),a.modificando_depart=!1):void 0},function(){return e.error("No se pudo traer las ciudades.")})},a.departamentoSeleccionado=function(c,d){return b.get("::ciudades/ciudades",{params:{departamento:c.departamento}}).then(function(b){return a.ciudades=b.data},function(){return e.error("No se pudo traer las ciudades.")})},a.crearCiudad=function(){return a.creandociudad=!0},a.crearDepartamento=function(){return a.creandodepartamento=!0},a.crearPais=function(){return a.creandopais=!0},a.guardarCiudad=function(){return b.post("::ciudades/guardarciudad",a.crearciudad).then(function(c){return e.success("Creado correctamente: "+c.data.ciudad),a.ciudades.push(c.data),a.creandociudad=!1,a.crearciudad={},a.guardar=!0,b.get("::paises/all").then(function(a){},a.paises=c.data,a.crearciudad.pais=d("filter")(a.paises,{id:1})[0],a.paisSeleccionado(a.crearciudad.pais),function(a){return e.error("No se pudo traer las ciudades.")})},function(a){return e.error("No se pudo crear","Error")})},a.guardarPais=function(){return b.post("::paises/guardar",a.crearpais).then(function(b){return e.success("Creado correctamente: "+b.data.paisnuevo),a.paises.push(b.data),a.paisSeleccionado(a.crearciudad.pais)},function(a){return e.error("No se pudo crear","Error")})},a.actualizarCiudad=function(a){return b.put("::ciudades/actualizar-ciudad",a).then(function(b){return e.success("Actualizado: "+a.ciudad),a.editandoCiudad=!1},function(a){return e.error("No se pudo actualizar","Error")})},a.actualizarDepartamento=function(c){return b.put("::ciudades/actualizar-departamento",c).then(function(b){var d;return e.success("Actualizado: "+c.departamento),c.editandoDepart=!1,d=a.crearciudad.pais,a.modificando_depart=!0,a.paisSeleccionado(d,c.departamento)},function(a){return e.error("No se pudo actualizar","Error")})},a.actualizarPais=function(a){return b.put("::paises/actualizar",a).then(function(b){return e.success("Actualizado: "+a.pais),a.editandoPais=!1,a.editandoAbrev=!1},function(a){return e.error("No se pudo actualizar","Error")})},a.eliminarUsuario=function(c){return b["delete"]("::usuarios/eliminar/"+c.id).then(function(b){return a.usuarios=d("filter")(a.usuarios,{id:"!"+c.id})},function(a){return console.log("No se pudo eliminar producto",a)})},a.editarUsuario=function(c){var e;return a.editando=!0,a.usuarioActualizar=c,e=d("filter")(a.tipos_doc,{tipo:a.usuarioActualizar.doc_tipo},!0),e=e.length>0?e[0]:a.tipos_doc[0],a.usuarioActualizar.doc_tipo=e,null===a.usuarioActualizar.ciudad_nac?(a.usuarioActualizar.pais={id:1,pais:"COLOMBIA",abrev:"CO"},a.paisSeleccionado(a.usuarioActualizar.pais,a.usuarioActualizar.pais)):b.get("::ciudades/datosciudad/"+a.usuarioActualizar.ciudad_nac).then(function(b){return a.paises=b.data.paises,a.departamentosNac=b.departamentos,a.ciudadesNac=b.ciudades,a.usuarioActualizar.pais=b.pais,a.usuarioActualizar.depart_nac=b.departamento,a.usuarioActualizar.ciudad_nac=b.ciudad})}}])}.call(this),function(){angular.module("feryzApp").config(["$stateProvider","App",function(a,b){return a.state("panel.configuraciones",{url:"^/configuraciones",views:{contenido_panel:{templateUrl:"==configuraciones/configuraciones.tpl.html",controller:"ConfiguracionesCtrl"}}})}])}.call(this),function(){angular.module("feryzApp").controller("ConfiguracionesCtrl",["$scope","$http","App","$filter","toastr",function(a,b,c,d,e){return a.configuracion={},a.guardar=function(c){return b.put("::configuracion/actualizar",a.configuracion).then(function(b){return e.success(a.configuracion.nombre_ips+' "Actualizada correctamente"')},function(a){return e.error("No se pudo Actualizar","Error"),console.log("No se pudo actualizar configuracion",a)})},a.traerConfiguracion=function(){return b.get("::configuracion/all").then(function(b){return a.configuracion=b.data[0]},function(a){return console.log("No se pudo traer la configuracion",a)})},a.traerConfiguracion()}])}.call(this),function(){"use strict";angular.module("feryzApp").config(["$stateProvider",function(a){return a.state("panel.filemanager",{url:"/filemanager",views:{contenido_panel:{templateUrl:"==fileManager/fileManager.tpl.html",controller:"FileManagerCtrl"}},data:{pageTitle:"Administrador de archivos"}})}])}.call(this),function(){"use strict";angular.module("feryzApp").controller("FileManagerCtrl",["$scope","Upload","$timeout","$filter","App","$http","Perfil","$uibModal","resolved_user","toastr","AuthService",function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n;a.USER=i,a.subir_intacta={},a.hasRoleOrPerm=k.hasRoleOrPerm,l=function(){return a.dato={imgUsuario:{id:a.USER.imagen_id,nombre:a.USER.image_nombre}}},l(),a.perfilPath=e.images+"perfil/",a.imgFiles=[],a.errorMsg="",a.fileReaderSupported=null!==window.FileReader&&(null===window.FileAPI||FileAPI.html5!==!1),a.dato.usuarioElegido=[],f.get("::imagenes/con-usuarios").then(function(b){return b=b.data,a.imagenes=b.imagenes,a.usuarios=b.usuarios,a.dato.usuarioElegido=b[0],a.dato.imgParaUsuario=b.imagenes[0]},function(a){return j.error("No se trajeron las imágenes y usuarios.")}),a.upload=function(b){var c,d,e,f,g;if(a.imgFiles=b,a.errorMsg="",b&&b.length){for(g=[],d=e=0,f=b.length;f>=0?f>e:e>f;d=f>=0?++e:--e)c=b[d],g.push(m(c));return g}},m=function(b){return a.errorMsg=null,n(b),a.generateThumb(b)},a.generateThumb=function(b){return null!==b&&a.fileReaderSupported&&b.type.indexOf("image")>-1?c(function(){var a;return a=new FileReader,a.readAsDataURL(b),a.onload=function(a){return c(function(){return b.dataUrl=a.target.result})}}):void 0},n=function(c){var d;return d=a.subir_intacta.intacta?"-intacta":"",c.size>1e7?void(a.errorMsg="Archivo excede los 10MB permitidos."):b.upload({url:e.Server+"imagenes/store"+d,file:c}).progress(function(a){var b;return b=parseInt(100*a.loaded/a.total),c.porcentaje=b}).success(function(b,c,d,e){return a.imagenes.push(b)}).error(function(a){return console.log("Falla uploading: ",a)}).xhr(function(a){})},a.pedirCambioUsuario=function(b){return f.put("::imagenes/cambiar-imagen-perfil/"+a.USER.id,{image_id:b.id}).then(function(c){return c=c.data,g.setImagen(c.imagen_id,b.nombre),a.$emit("cambianImgs",{image:c}),j.success("Imagen principal cambiada")},function(a){return j.error("No se pudo cambiar imagen","Problema")})},a.cambiarLogo=function(a){return f.put("::imagenes/cambiar-logo",{logo_id:a.id}).then(function(a){return j.success("Logo de la empresa cambiado")},function(a){return j.error("No se pudo cambiar el logo","Problema")})},a.fotoSelect=function(a,b){},a.rotarImagen=function(a){return f.put("::imagenes/rotarimagen/"+a.id).then(function(b){return a.nombre="",j.success("Imagen rotada"),a.nombre=b+"?"+(new Date).getTime()},function(a){return j.error("Imagen no rotada")})},a.borrarImagen=function(b){var c;return c=h.open({templateUrl:"==fileManager/removeImage.tpl.html",controller:"RemoveImageCtrl",size:"sm",resolve:{imagen:function(){return b}}}),c.result.then(function(b){return a.imagenes=d("filter")(a.imagenes,{id:"!"+b.id})})},a.usuarioSelect=function(b,c){return a.dato.selectUsuarioModel=b},a.cambiarFotoUnUsuario=function(a,b){var c;return c={imgUsuario:b.id},f.put("::perfiles/cambiar-img-usuario/"+a.id,c).then(function(a){return j.success("Foto oficial asignada con éxito")},function(a){return j.error("Error al asignar foto al usuario","Problema")})},a.pedirCambioFirma=function(a,b){var c;return c={imgFirma:b.id},f.put("::perfiles/cambiar-firma/"+a.id,c).then(function(a){return j.success("Firma asignada con éxito")},function(a){return j.error("Error al asignar firma","Problema")})}}])}.call(this),function(){angular.module("feryzApp").controller("RemoveImageCtrl",["$scope","$uibModalInstance","imagen","App","$http","AuthService","toastr",function(a,b,c,d,e,f,g){a.imagesPath=d.images+"perfil/",a.imagen=c,a.hasRoleOrPerm=f.hasRoleOrPerm,a.ok=function(){return e["delete"]("::imagenes/destroy/"+c.id).then(function(a){return g.success("La imagen ha sido removida.")},function(a){return g.error("No se pudo eliminar la imagen.")}),b.close(c)},a.cancel=function(){return b.dismiss("cancel")}}])}.call(this),function(){angular.module("feryzApp").config(["$stateProvider","App",function(a,b){return a.state("panel.inventarios",{url:"^/inventarios",views:{contenido_panel:{templateUrl:"==inventarios/inventarios.tpl.html",controller:"InventariosCtrl"}}})}])}.call(this),function(){angular.module("feryzApp").controller("InventariosCtrl",["$scope","$http","App","$filter","toastr","USER_ROLES","AuthService",function(a,b,c,d,e,f,g){var h,i,j;return g.verificar_acceso(),a.hasRole=g.hasRole,a.USER_ROLES=f,a.USER=a.USER,h=a.USER,a.creando=!1,a.editando=!1,a.traerDatos=function(){return b.put("::inventarios/datos").then(function(b){return b=b.data,a.inventarios=b.inventarios,a.detalles_inventario_actual=b.detalles_inventario_actual,a.inventario_actual=b.inventario_actual,a.opcionesGrid.data=b.detalles_inventario_actual},function(a){return e.error("Error trayendo los datos."),console.log("No se pudo traer los datos",a)})},a.traerDatos(),a.seleccionarInventario=function(b){var c,d,e,f;for(f=a.inventarios,c=0,e=f.length;e>c;c++)d=f[c],d.seleccionado=!1;return b.seleccionado=!0},a.guardar=function(c){return b.put("::configuracion/actualizar",a.configuracion).then(function(b){return e.success(a.configuracion.nombre_ips+' "Actualizada correctamente"')},function(a){return e.error("No se pudo Actualizar","Error"),console.log("No se pudo actualizar configuracion",a)})},i='<span class="btn-group"><a class="btn btn-default btn-xs" ng-click="grid.appScope.editarProducto(row.entity)"><md-tooltip md-direction="left">Editar</md-tooltip><i class="fa fa-edit "></i>Edit</a>',j='<a class="btn btn-danger btn-xs" ng-click="grid.appScope.quitarProducto(row.entity)"><md-tooltip md-direction="left">Quitar</md-tooltip><i class="fa fa-times "></i></a><span>',a.opcionesGrid={showGridFooter:!0,enableSorting:!1,enableColumnMenus:!1,enableFiltering:!0,enableCellEdit:!0,enableCellEditOnFocus:!0,gridFooterTemplate:'<div class="ui-grid-footer-info ui-grid-grid-footer row"><span class="col-lg-4 col-sm-4">Productos: {{grid.rows.length}}<span ng-if="grid.renderContainers.body.visibleRowCache.length !== grid.rows.length" class="ngLabel"> (mostrando {{grid.renderContainers.body.visibleRowCache.length}})</span></span>   <span class="col-lg-8 col-sm-8 formato-total">{{grid.appScope.totalCompra(grid.rows)}}</span></div>',columnDefs:[{field:"No",width:60,enableCellEdit:!1,cellTemplate:'<div class="ui-grid-cell-contents">{{rowRenderIndex + 1}}</div>'},{field:"Ed",displayName:"",cellTemplate:j,width:35,enableCellEdit:!1,enableFiltering:!1},{field:"nombre",displayName:"Producto",minWidth:270,enableCellEdit:!1},{field:"iva",type:"text",cellTemplate:'<div class="ui-grid-cell-contents">{{row.entity.iva | number:0}}%</div>',enableCellEdit:!1,width:50},{field:"precio_costo",displayName:"$Costo",cellFilter:"currency:undefined:grid.appScope.USER.deci_entrada",cellClass:"grid-align-right",minWidth:80},{field:"precio_venta",displayName:"$Venta",cellFilter:"currency:undefined:grid.appScope.USER.deci_salida",cellClass:"grid-align-right",minWidth:70},{displayName:"Diferencia",name:"Diferencia",enableSorting:!0,enableCellEdit:!1,cellFilter:"number",minWidth:100,cellTemplate:'<div class="ui-grid-cell-contents" style="text-align: right">{{ (row.entity.precio_venta - row.entity.precio_costo) | currency:undefined:grid.appScope.USER.deci_total}}</div>'},{field:"cantidad",displayName:"Cant",enableSorting:!0,cellFilter:"number",minWidth:50,maxWidth:70}],onRegisterApi:function(c){return a.gridApi=c,c.edit.on.afterCellEdit(a,function(c,d,f,g){return f!==g&&"nombre"===d.field&&b.put("::productos/actualizar-nombre",{producto_id:c.producto.id,nombre:c.nombre}).then(function(a){return e.success("Nombre de Producto actualizado","Actualizado")},function(a){return e.error("Cambio no guardado","Error")}),a.$apply()})}}}])}.call(this),function(){angular.module("feryzApp").factory("AuthService",["App","$state","$http","$cookies","Perfil","$rootScope","AUTH_EVENTS","$q","$filter","toastr",function(a,b,c,d,e,f,g,h,i,j){var k;return k={},k.verificando=!1,k.promesa_de_verificacion={},k.verificar=function(){var a;return k.verificando?k.promesa_de_verificacion:(a=h.defer(),e.User().id?a.resolve(e.User()):d.get("xtoken")?void 0!==d.get("xtoken")&&"undefined"!==d.get("xtoken")&&"[object Object]"!==d.get("xtoken")?k.login_from_token().then(function(b){return e.setUser(b),a.resolve(b)},function(b){return console.log("No se logueó from token"),a.reject(b)}):(console.log("Token mal estructurado: ",d.get("xtoken")),k.borrarToken(),f.$broadcast(g.notAuthenticated),
a.reject("Token mal estructurado.")):(console.log("No hay cookie token."),a.reject("No hay cookie token."),b.go("login"),f.$broadcast(g.notAuthenticated)),k.promesa_de_verificacion=a.promise,k.promesa_de_verificacion)},k.verificar_acceso=function(){var a,c;return e.User().id||b.go("login"),c=b.current,c.data.needed_roles?(a=c.data.needed_roles,k.isAuthorized(a)?!0:(console.log("No tiene permisos, y... "),f.lastState=c.name,k.isAuthenticated()?(f.$broadcast(g.notAuthorized),console.log("...está Autenticado.")):(console.log("...NO está Autenticado."),b.transitionTo("login")))):!0},k.login_credentials=function(a){var i;return i=h.defer(),k.borrarToken(),c.post("::login/login",a).then(function(a){return a.data.token?(d.put("xtoken",a.data.token),c.defaults.headers.common.Authorization="Bearer "+d.get("xtoken"),e.setUser(a.data),f.$broadcast(g.loginSuccess),i.resolve(a.data)):(f.$broadcast(g.loginFailed),i.reject("Error en login"))},function(a){return f.$broadcast(g.loginFailed),a?a.status?400===a.status?j.error("Datos inválidos","",{timeOut:8e3}):-1===a.status?j.error("No parece haber comunicación con el servidor","",{timeOut:8e3}):500===a.status&&j.error("No parece haber comunicación con la Base de datos","",{timeOut:8e3}):a.data?a.data.error&&("Token expirado"===a.data.error||"token_expired"===a.error?(j.warning("La sesión ha expirado"),"login"!==b.current.name&&b.go("login")):f.$broadcast(g.loginFailed)):j.error("No parece haber comunicación con el servidor"):j.error("No parece haber comunicación con el servidor"),i.reject("Error en login")}),i.promise},k.login_from_token=function(){var a,b;return a=h.defer(),e.User().id||void 0===e.User().id?(c.defaults.headers.common.Authorization="Bearer "+d.get("xtoken"),b=c.post("::login/verificar").then(function(b){return f.$broadcast(g.loginSuccess),a.resolve(b.data)},function(b){return console.log("No se pudo loguear con token. ",b),a.reject("Error en login con token."),f.$broadcast(g.loginFailed)})):a.resolve(e.User()),a.promise},k.logout=function(a){return f.lastState=null,f.lastStateParam=null,k.borrarToken(),e.deleteUser(),b.transitionTo("login")},k.borrarToken=function(){return d.remove("xtoken"),delete c.defaults.headers.common.Authorization},k.isAuthenticated=function(){return!!e.User().id},k.isAuthorized=function(a){var b,c;return c=e.User(),c.is_superuser?!0:(angular.isArray(a)||(a=[a]),0===a.length?!0:(b=[],_.each(a,function(a){return c.tipo===a?b.push(a):void 0}),k.isAuthenticated()&&b.length>0))},k.hasRole=function(a){var b,c;return c=e.User(),c.is_superuser?!0:(b=[],_.each(a,function(a){return c.tipo===a?b.push(a):void 0}),k.isAuthenticated()&&b.length>0)},k}])}.call(this),function(){angular.module("feryzApp").factory("Perfil",["App","AUTH_EVENTS","$http",function(a,b,c){var d;return d={},{setUser:function(a){return d=a},User:function(){return d},id:function(){return d.user_id},idioma:function(){return d.idioma_main_id},setImagen:function(a,b){return d.imagen_id=a,d.image_nombre=b},deleteUser:function(){return d={}}}}]).factory("removeAccents",["App",function(a){var b;return b={},b.search="",b.removeAccents=function(a){return a.replace(/á/g,"a").replace(/â/g,"a").replace(/é/g,"e").replace(/è/g,"e").replace(/ê/g,"e").replace(/í/g,"i").replace(/ï/g,"i").replace(/ì/g,"i").replace(/ó/g,"o").replace(/ô/g,"o").replace(/ú/g,"u").replace(/ü/g,"u").replace(/ç/g,"c").replace(/ß/g,"s")},b.ignoreAccents=function(a){var c;return b.search?(c=b.removeAccents(a.nombre.toLowerCase()),b.search=b.removeAccents(b.search.toLowerCase()),c.indexOf(b.search)>-1):!0},b}])}.call(this),function(){angular.module("feryzApp").factory("Local",["App","$http","$q","$timeout",function(a,b,c,d){var e,f,g,h,i;return i={},e=window.openDatabase("MyVc.db","1","My Virtual College",5242880),e.transaction(function(a){return i=a}),h="CREATE TABLE IF NOT EXISTS entradas (id integer,fecha date DEFAULT NULL ,tipo varchar(100)  DEFAULT NULL collate nocase,proveedor_id integer DEFAULT NULL,cancelada integer DEFAULT NULL,created_at date DEFAULT NULL)",g="CREATE TABLE IF NOT EXISTS entradas_detalles (id integer, entrada_id integer DEFAULT NULL, producto_id integer DEFAULT NULL,cantidad integer default NULL,precio_costo decimal(11,3) default NULL,precio_venta decimal(11,3) default NULL, nombre_grupo varchar(100) default NULL)",f={createTables:function(){var a;return a=c.defer(),e.transaction(function(b){return b.executeSql(h,[],function(a,b){return console.log("Tabla entradas creada")},function(a,b){return console.log("Tabla entradas NO se pudo crear",b.message)}),b.executeSql(g,[],function(b,c){return console.log("Tabla entradas_detalles creada"),a.resolve("Hasta tabla entradas creada")},function(a,b){return console.log("Tabla entradas_detalles NO se pudo crear",b.message)})}),a.promise},deleteTables:function(){var a;return a=c.defer(),e.transaction(function(a){return a.executeSql("DROP TABLE entradas",[],function(a,b){return console.log("Tabla entradas eliminada")},function(a,b){return console.log("entradas, Could not delete",b.message)})}),e.transaction(function(a){return a.executeSql("DROP TABLE entradas_detalles",[],function(a,b){return console.log("Tabla entradas_detalles eliminada")},function(a,b){return console.log("entradas_detalles, Could not delete",b.message)})}),a.promise},query:function(a,b){var d;return d=c.defer(),("undefined"==typeof b||void 0===b)&&(b=[]),e.transaction(function(c){return c.executeSql(a,b,function(a,b){var c,e,f,g,h,i;for(e=[],h=b.rows,c=f=0,g=h.length;g>f;c=++f)i=h[c],e.push(b.rows.item(c));return d.resolve(e)},function(c,e){return console.log(e.message,a,b),d.reject(e.message)})}),d.promise},getEntradasSinGuardar:function(){var a,b;return a=c.defer(),b="SELECT rowid, id, fecha, tipo, proveedor_id, cancelada, created_at FROM entradas",this.query(b).then(function(b){var c;return c=b,angular.forEach(c,function(b,c){var d;return d="SELECT * FROM entradas_detalles",f.query(d).then(function(a){return b.productos_agregados=a},function(b){return console.log("Pailas trayendo detalles en Local"),a.reject("detalle entrada Local")})},this),d(function(){return a.resolve(c)},50)},function(b){return console.log("Pailas trayendo entradas en Local"),a.reject("entradas Local")}),a.promise},insertEntrada:function(a){var b,c,d,e;return b=new Date,d=b.toISOString().slice(0,10),c=[d,!1,b],e="INSERT INTO entradas (fecha, cancelada, created_at) VALUES (?,?,?)",this.query(e,c)},deleteEntrada:function(a){var b,d;return b=c.defer(),d="DELETE FROM entradas WHERE rowid=?",e.transaction(function(c){return c.executeSql(d,[a],function(a,c){return c.rowsAffected>0?b.resolve("Eliminado"):(b.reject("No se eliminó nada"),console.log("No se eliminó nada"))},function(a,c){return console.log(c.message,d,datos),b.reject(c.message)})}),b.promise}}}])}.call(this),function(){angular.module("feryzApp").directive("updateTitle",["$rootScope","$timeout",function(a,b){return{link:function(c,d){var e;return e=function(a,c,e){var f;return f="Feryz",c.data&&c.data.pageTitle&&(f=c.data.pageTitle),e&&e.username&&(f=e.username+" - Feryz"),b(function(){return d.text(f)},0,!1)},a.$on("$stateChangeSuccess",e)}}}])}.call(this),function(){angular.module("feryzApp").directive("focusMe",["$timeout","$parse",function(a,b){return{scope:{trigger:"=focusMe"},link:function(a,b,c){return a.$watch("trigger",function(c){return c===!0?(b[0].focus(),a.trigger=!1):void 0})}}}])}.call(this),function(){angular.module("feryzApp").filter("porIdioma",[function(){return function(a,b){var c,d,e,f,g;if(a){for(g=[],b=parseFloat(b),d=0,f=a.length;f>d;d++)c=a[d],e=parseFloat(c.idioma_id),b===e&&g.push(c);return g}return!1}}])}.call(this);